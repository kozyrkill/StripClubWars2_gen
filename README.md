# SCW Character Image Pack Generator

Генератор имедж-паков персонажей для игры Strip Club Wars 2 с использованием Stable Diffusion WebUI.

## Возможности

- ✅ Автоматическая генерация всех типов изображений персонажей (13 поз)
- ✅ Поддержка всех атрибутов персонажей из игры (пол, этничность, возраст, телосложение)
- ✅ Правильное именование файлов согласно стандартам SCW
- ✅ Автоматическое удаление фона с изображений
- ✅ Подходящие размеры изображений (512x800 для тела, 120x160 для головы)
- ✅ Конфигурация персонажей через JSON файлы
- ✅ Пакетная генерация множества персонажей

## Установка

### Требования

1. **Stable Diffusion WebUI** должен быть запущен на порту 7860 с включенным API:
   ```bash
   python launch.py --api
   ```

2. **Python 3.8+** с pip

### Установка зависимостей

```bash
pip install -r requirements.txt
```

## Использование

### Быстрый старт

Генерация тестовых персонажей:

```bash
python scw_image_generator.py --test
```

### Генерация из конфигурации

Создайте или отредактируйте файл `character_config.json` и запустите:

```bash
python scw_image_generator.py --config character_config.json
```

### Параметры командной строки

```bash
python scw_image_generator.py --help
```

Доступные параметры:
- `--output-dir` - директория для сохранения изображений (по умолчанию: `generated_characters`)
- `--modkey` - ключ мода для имен файлов (по умолчанию: `custom`)
- `--test` - генерировать тестовых персонажей
- `--config` - путь к JSON файлу с конфигурацией персонажей
- `--count` - ограничить количество персонажей из конфигурации

### Примеры использования

```bash
# Генерация тестовых персонажей
python scw_image_generator.py --test

# Генерация из конфигурации с собственным ключом мода
python scw_image_generator.py --config character_config.json --modkey mymod

# Генерация только первых 3 персонажей из конфигурации
python scw_image_generator.py --config character_config.json --count 3

# Сохранение в определенную папку
python scw_image_generator.py --test --output-dir ./my_characters
```

## Структура конфигурации

Файл `character_config.json` содержит настройки персонажей:

```json
{
  "character_presets": [
    {
      "name": "young_woman",
      "gender": "f",
      "age_group": 2,
      "ethnicity": "w",
      "body_shape": "n",
      "hair_color": "l",
      "hair_length": "l"
    }
  ],
  "generation_settings": {
    "default_poses": ["head", "cas", "uw", "nude"],
    "steps": 30,
    "cfg_scale": 7.5
  }
}
```

### Атрибуты персонажей

#### Обязательные атрибуты (reqphys)
- `gender`: пол - `"f"` (женский) или `"m"` (мужской)
- `age_group`: возрастная группа - `1-5` (18-24, 22-31, 28-42, 38-51, 48+)
- `ethnicity`: этничность - `"w"` (белый), `"b"` (черный), `"h"` (латиноамериканец), `"a"` (азиат), `"r"` (ближневосточный)

#### Опциональные атрибуты (optphys)
- `height`: рост - `"t"` (высокий), `"m"` (средний), `"s"` (низкий)
- `body_shape`: телосложение - `"s"` (худой), `"n"` (обычный), `"c"` (пышный), `"f"` (спортивный)
- `hips_size`: размер бедер - `"s"` (маленький), `"m"` (средний), `"l"` (большой)
- `breast_penis_size`: размер груди/пениса - `"s"`, `"m"`, `"l"`, `"h"` (огромный)
- `skin_tone`: тон кожи - `"l"` (светлый), `"m"` (средний), `"d"` (темный)

#### Атрибуты изображения (imgphys)
- `hair_color`: цвет волос - `"l"` (светлый), `"m"` (средний), `"d"` (темный)
- `hair_length`: длина волос - `"b"` (лысый), `"s"` (короткие), `"m"` (средние), `"l"` (длинные)
- `eye_color`: цвет глаз - `"l"` (светлый), `"m"` (средний), `"d"` (темный)

## Типы поз

Генератор создает следующие изображения:

### Базовые позы (для всех)
- `head` - портрет/голова (120x160px)
- `cas` - повседневная одежда
- `uw` - нижнее белье
- `nude` - обнаженный

### Дополнительные позы
- `bc` - деловая повседневная одежда
- `biz` - деловой костюм
- `fun` - спортивная/домашняя одежда

### Только для женщин
- `tl` - топлесс
- `ss` - купальник
- `s1` - стриптизерский наряд 1
- `s2` - стриптизерский наряд 2 (более откровенный)
- `s3` - стриптизерский наряд 3 (очень откровенный)
- `preg` - беременная

## Формат имен файлов

Генератор создает файлы в соответствии с требованиями SCW:

### Для головы
```
modkey-id-reqphys-optphys-imgphys-special-head.png
custom-01000-f2w-mnmml-llm-u-head.png
```

### Для остальных поз
```
modkey-id-reveal-pose.png
custom-01000-z0-cas.png
custom-01000-z9-nude.png
```

## Интеграция в игру

1. Скопируйте сгенерированные изображения в директорию персонажей игры
2. Добавьте ваш `modkey` в файл конфигурации игры:
   ```
   image_modules string scw,custom
   ```

## Решение проблем

### WebUI не отвечает
- Убедитесь что Stable Diffusion WebUI запущен с флагом `--api`
- Проверьте что WebUI доступен по адресу http://localhost:7860

### Ошибки генерации
- Проверьте журнал WebUI на предмет ошибок
- Убедитесь что у вас достаточно VRAM для генерации изображений
- Попробуйте уменьшить количество шагов в конфигурации

### Плохое качество удаления фона
- Библиотека `rembg` может работать не идеально на всех изображениях
- При необходимости отредактируйте изображения вручную

## Лицензия

Этот проект создан для использования с игрой Strip Club Wars 2.

## Вклад

Если у вас есть предложения по улучшению или вы нашли баги, создавайте issues или pull requests.
